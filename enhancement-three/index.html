<!DOCTYPE HTML>
<html>
<head>
    <title>Enhancement Three: Safe Delete Backup History</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../assets/css/main.css" />

    <!-- Prism.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>

    <style>
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-left: 4px solid #3498db;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, monospace;
        }
        p {
            margin-bottom: 1em;
        }
        h3 {
            margin-top: 1.5em;
            color: #2c3e50;
        }
    </style>
</head>

<body class="is-preload">

<div id="wrapper">

    <!-- Main -->
    <div id="main">
        <div class="inner">

            <!-- Header -->
            <header id="header">
                <a href="../index.html" class="logo"><strong>Samit Datta</strong></a>
                <ul class="icons">
                    <li>
                        <a href="https://github.com/samitcodes" class="icon brands fa-github" target="_blank">
                            <span class="label">GitHub</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/samitdattaofficial/" class="icon brands fa-linkedin" target="_blank">
                            <span class="label">LinkedIn</span>
                        </a>
                    </li>
                </ul>
            </header>

            <!-- Page Title -->
            <section>
                <header class="main">
                    <h2>Enhancement Three: Safe Delete Backup History</h2>
                </header>

                <!-- GitHub Button -->
                <div class="github-button">
                    <a href="https://github.com/samitcodes/WeightTrackerApp/tree/3610ef253906b345917ce0a64c86eed046fb0efc/Enhancement3/DattaCS499EnchantmentThree"
                       class="button small"
                       target="_blank"
                       rel="noopener noreferrer">
                        <i class="fab fa-github" style="margin-right: 0.5em;"></i>
                        Enhancement Three Repository
                    </a>
                </div>

                <!-- Content -->
                <div class="content">

                    <h3>Artifact Description</h3>
                    <p>
                        This enhancement extends my original weight tracking application from CS360 by implementing
                        a safe-delete backup history system. Instead of permanently deleting user accounts and weight
                        records, the system introduces a soft-deletion strategy that preserves data while preventing
                        unauthorized access.
                    </p>
                    <p>
                        When a deletion occurs, records are marked inactive rather than destroyed. This ensures that
                        historical health data remains intact for recovery, auditing, and long-term system reliability,
                        while enforcing strict access control for inactive users.
                    </p>

                    <h3>Database Versioning and Schema Migration</h3>
                    <p>
                        To safely introduce soft deletion without impacting existing data, the database version
                        was incremented and a controlled schema migration strategy was implemented.
                    </p>

                    <pre><code class="language-java">private static final int DATABASE_VERSION = 2;

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    if (oldVersion &lt; 2) {
        db.execSQL("ALTER TABLE users ADD COLUMN is_deleted INTEGER DEFAULT 0");
        db.execSQL("ALTER TABLE weights ADD COLUMN is_deleted INTEGER DEFAULT 0");
    }
}</code></pre>

                    <h3>User Account Soft Deletion</h3>
                    <p>
                        When a user chooses to delete their account, the application does not remove the user record.
                        Instead, it updates the deletion flag, immediately blocking authentication while preserving
                        all associated data.
                    </p>

                    <pre><code class="language-java">public boolean softDeleteUser(int userId) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues cv = new ContentValues();
    cv.put("is_deleted", 1);

    int result = db.update(
        "users",
        cv,
        "id = ?",
        new String[]{String.valueOf(userId)}
    );
    return result &gt; 0;
}</code></pre>

                    <h3>Authentication Enforcement</h3>
                    <p>
                        Authentication logic explicitly excludes inactive accounts, ensuring that soft-deleted users
                        cannot access the application even if valid credentials are provided.
                    </p>

                    <pre><code class="language-java">public boolean checkUser(String username, String password) {
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.query(
        "users",
        new String[]{"id"},
        "username = ? AND password = ? AND is_deleted = 0",
        new String[]{username, password},
        null, null, null
    );
    boolean exists = cursor.getCount() &gt; 0;
    cursor.close();
    return exists;
}</code></pre>

                    <h3>Soft Deletion of Weight Records</h3>
                    <p>
                        Individual weight entries can also be safely deleted. This allows users to recover accidental
                        deletions while maintaining data integrity.
                    </p>

                    <pre><code class="language-java">public boolean softDeleteWeight(int id, int userId) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues cv = new ContentValues();
    cv.put("is_deleted", 1);

    int result = db.update(
        "weights",
        cv,
        "id = ? AND user_id = ?",
        new String[]{String.valueOf(id), String.valueOf(userId)}
    );
    return result &gt; 0;
}</code></pre>

                    <h3>Recovery of Deleted Records</h3>
                    <p>
                        The backup history feature allows previously deleted records to be restored instantly without
                        requiring data migration or secondary storage systems.
                    </p>

                    <pre><code class="language-java">public boolean recoverWeight(int id, int userId) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues cv = new ContentValues();
    cv.put("is_deleted", 0);

    int result = db.update(
        "weights",
        cv,
        "id = ? AND user_id = ?",
        new String[]{String.valueOf(id), String.valueOf(userId)}
    );
    return result &gt; 0;
}</code></pre>

                    <h3>Permanent Deletion as a Controlled Operation</h3>
                    <p>
                        Permanent deletion is intentionally separated from standard delete operations and requires
                        explicit user intent, minimizing the risk of irreversible data loss.
                    </p>

                    <pre><code class="language-java">public boolean permanentDeleteWeight(int id, int userId) {
    SQLiteDatabase db = this.getWritableDatabase();
    int result = db.delete(
        "weights",
        "id = ? AND user_id = ?",
        new String[]{String.valueOf(id), String.valueOf(userId)}
    );
    return result &gt; 0;
}</code></pre>

                    <h3>Justification for Inclusion</h3>
                    <p>
                        The safe delete backup history was ideal for this because it manages
                        sensitive health-related data that requires a higher standard of security and reliability
                        than typical application data. Weight records are inherently personal and confidential,
                        making the principles of confidentiality, integrity, and availability critical to the
                        systemâ€™s design.
                    </p>
                    <p>
                        This enhancement demonstrates that databases are not merely passive storage components,
                        but active enforcers of application logic and security constraints. Through the use of
                        soft deletion, filtered queries, and well-defined table relationships, the database
                        prevents unauthorized access, invalid operations, and accidental data loss. These design
                        decisions highlight my ability to implement secure, scalable database solutions that
                        support long-term system reliability and responsible data management.
                    </p>

                    <h3>Reflection</h3>
                    <p>
                        During the development of this enhancement, my initial approach was to introduce a
                        secondary database to serve as a backup storage system. However, after evaluating the
                        complexity of synchronizing multiple databases, I recognized that this solution would
                        introduce unnecessary risk and inefficiency. Data replication increases the likelihood
                        of inconsistencies, corruption, and system failures, particularly in applications that
                        require frequent updates.
                    </p>
                    <p>
                        This enchancement enables immediate recovery,
                        eliminates the need for data migration, and avoids the overhead of managing redundant
                        storage systems. One of the most challenging aspects of this enhancement was ensuring
                        that inactive users were fully restricted from accessing the application while preserving
                        all historical data.
                    </p>
                    <p>
                        This experience strengthened my understanding of effective database design by emphasizing
                        prevention, recoverability, and controlled access over destructive operations. It
                        reinforced the idea that simple, well-structured architecture often provides stronger
                        security and reliability than complex redundancy, especially in real-world applications.
                    </p>

                </div>
            </section>

        </div>
    </div>

    <!-- Sidebar -->
    <div id="sidebar">
        <div class="inner">
            <nav id="menu">
                <header class="major">
                    <h2>Menu</h2>
                </header>
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../codereview/">Code Review</a></li>
                    <li><a href="../enhancement-one/">Enhancement One</a></li>
                    <li><a href="../enhancement-two/">Enhancement Two</a></li>
                    <li><a href="../enhancement-three/">Enhancement Three</a></li>
                    <li><a href="../professional-self-assessment/">Professional Self Assessment</a></li>
                </ul>
            </nav>
        </div>
    </div>

</div>

<!-- Prism.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>

<!-- HTML5 UP -->
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/browser.min.js"></script>
<script src="../assets/js/breakpoints.min.js"></script>
<script src="../assets/js/util.js"></script>
<script src="../assets/js/main.js"></script>

</body>
</html>
